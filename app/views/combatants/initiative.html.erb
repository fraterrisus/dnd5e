<% content_for :head do %>
  <%= javascript_include_tag 'combatants/initiative' %>
<% end %>

<h1>Combat: Initiative</h1>

<%
def init_list_item(name, count)
  content_tag(:div, class: %w( list-group-item )) do
    content_tag(:span, count, class: 'init-count') <<
    content_tag(:span, name, class: 'init-name' ) <<
    content_tag(:span, '', class: 'badge')
  end
end
%>

<%= 
content_tag(:div, class: %w( panel panel-default )) do
  content_tag(:div, class: %w( panel-heading )) do
    content_tag(:h2, 'Turn Order', class: %w( panel-title ))
  end <<
  content_tag(:div, class: %w( panel-body )) do
    content_tag(:div, class: %w( btn-group ), style: 'margin-bottom: 10px',
                role: 'group', 'aria-label' => 'cycle') do
      button_tag('Next Turn', class: %w( btn btn-primary ), id: 'nextturn')
    end <<
    content_tag(:div, class: %w( btn-group ),
                style: 'margin-left: 10px; margin-bottom: 10px',
                role: 'group', 'aria-label' => 'modify combatants') do
      button_tag('New', id: 'new-btn', class: %w( btn btn-default ), 
                 'data-toggle' => 'modal', 'data-target' => '#newcomb-modal') <<
      button_tag('Clear', id: 'clear-btn', class: %w( btn btn-default )) 
    end <<
    content_tag(:div, class: %w( btn-group ), 'data-toggle' => 'buttons',
                style: 'margin-left: 10px; margin-bottom: 10px',
                role: 'group', 'aria-label' => 'toggles') do
      content_tag(:label, class: %w( btn btn-default active ), 'aria-pressed' => true) do
        check_box_tag(:autoupdate, 1, true, autocomplete: 'off') << 'Auto-update'
      end
    end <<
    content_tag(:div, nil, id: 'initiative-list' )
  end
end
%>

<%= bootstrap_modal('newcomb', Combatant, 'New Combatant', 
                    { submit_label: 'Add', inline: false }) do |f|
  content_tag(:div, class: %w( form-group row )) do
    content_tag(:div, class: %w( col-xs-12 col-sm-9 )) do
      f.label(:name) <<
      f.text_field(:name, class: 'form-control')
    end <<
    content_tag(:div, class: %w( col-xs-4 col-sm-3 )) do
      f.label(:count) <<
      f.text_field(:count, class: %w( form-control col-xs-2 ))
    end
  end 
end
%>

<%= bootstrap_modal('editcomb', Combatant, 'Edit Combatant', 
                    { form: { method: 'PATCH' }, submit_label: 'Update', inline: false }) do |f|
  content_tag(:div, class: %w( form-group row )) do
    content_tag(:div, class: %w( col-xs-12 col-sm-9 )) do
      f.label(:name) <<
      f.text_field(:name, class: 'form-control')
    end <<
    content_tag(:div, class: %w( col-xs-4 col-sm-3 )) do
      f.label(:count) <<
      f.text_field(:count, class: %w( form-control col-xs-2 ))
    end
  end 
end
%>
