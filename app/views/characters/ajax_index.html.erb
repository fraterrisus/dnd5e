<% attributes = %i(str dex con int wis chr perception initiative speed ac) %>
<%= tag.table(id: 'character-table', class: %w(table table-condensed)) do %>
  <%= tag.tr do %>
    <%= tag.th %>
    <%= tag.th('Name') %>
    <%= tag.th('S', title: 'Strength') %>
    <%= tag.th('D', title: 'Dexterity') %>
    <%= tag.th('C', title: 'Constitution') %>
    <%= tag.th('I', title: 'Intelligence') %>
    <%= tag.th('W', title: 'Wisdom') %>
    <%= tag.th('C', title: 'Charisma') %>
    <%= tag.th('Per', title: 'Perception') %>
    <%= tag.th('Init', title: 'Initiative') %>
    <%= tag.th('Spd', title: 'Speed') %>
    <%= tag.th('AC', title: 'Armor Class') %>
  <% end %>
  <% @chars.each do |c| %>
    <% second_row = (c.notes && c.notes != "") %>
    <% tr_klass = c.highlight ? %w(table-info) : [] %>
    <% td_attrs = second_row ? { rowspan: 2 } : {} %>

    <%= tag.tr(class: tr_klass, data: { 'char-id': c.id }) do %>
      <%= tag.td(td_attrs) do %>
        <%= tag.a('', class: %(fas fa-edit edit-button)) %>
        <%= tag.a('', class: %(fas fa-trash delete-button)) %>
      <% end %>
      <%= tag.td(c.name, td_attrs) %>
      <% attributes.each do |meth| %><%= tag.td(c.send(meth)) %><% end %>
    <% end %>

    <% if second_row %>
      <%= tag.tr(class: tr_klass, 'data-notes-id' => c.id) do %>
        <%= tag.td(c.notes, colspan: 30) %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
