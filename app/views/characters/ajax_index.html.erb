<% attributes = %i(str dex con int wis chr perception initiative speed ac) %>
<%= tag.div(class: %w(table-responsive)) do %>
  <%= tag.table(id: 'character-table', class: %w(table table-sm)) do %>
    <%= tag.tr do %>
      <%= tag.th %>
      <%= tag.th('Name') %>
      <%= tag.th('Str', title: 'Strength', class: %w(text-center)) %>
      <%= tag.th('Dex', title: 'Dexterity', class: %w(text-center)) %>
      <%= tag.th('Con', title: 'Constitution', class: %w(text-center)) %>
      <%= tag.th('Int', title: 'Intelligence', class: %w(text-center)) %>
      <%= tag.th('Wis', title: 'Wisdom', class: %w(text-center)) %>
      <%= tag.th('Chr', title: 'Charisma', class: %w(text-center)) %>
      <%= tag.th('Per', title: 'Perception', class: %w(text-center)) %>
      <%= tag.th('Init', title: 'Initiative', class: %w(text-center)) %>
      <%= tag.th('Spd', title: 'Speed', class: %w(text-center)) %>
      <%= tag.th('AC', title: 'Armor Class', class: %w(text-center)) %>
    <% end %>
    <% @chars.each do |c| %>
      <% second_row = (c.notes && c.notes != "") %>
      <% tr_klass = c.highlight ? %w(table-info) : [] %>
      <% td_attrs = second_row ? { rowspan: 2 } : {} %>

      <%= tag.tr(class: tr_klass, data: { 'char-id': c.id }) do %>
        <%= tag.td(td_attrs) do %>
          <%= tag.a('', class: %(fas fa-edit edit-button)) %>
          <%= tag.a('', class: %(fas fa-trash delete-button)) %>
        <% end %>
        <%= tag.td(c.name, td_attrs) %>
        <% attributes.each do |meth| %><%= tag.td(c.send(meth), class: %w(text-center)) %><% end %>
      <% end %>

      <% if second_row %>
        <%= tag.tr(class: tr_klass, 'data-notes-id' => c.id) do %>
          <%= tag.td(c.notes, colspan: 30) %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
