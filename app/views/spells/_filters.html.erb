<%=
content_tag(:div, id: 'active-filters') do
  safe_join(filters.map do |k,v|
    v = [ v ] unless v.is_a?(Array)
    desc = [ ]
    v.each do |val|
      case k
      when 'school_id'
        desc << SpellSchool::to_s(val.to_i)
      when 'level'
        desc << Spell::level_to_s(val.to_i)
      when 'cast_unit', 'duration_unit'
        desc << TimeUnit::to_s(val.to_i).capitalize
      when 'range_unit'
        desc << DistanceUnit::to_s(val.to_i).capitalize
      when 'ritual', 'concentration'
        desc << (val == 't' ? 'Yes' : 'No')
      when 'components'
        desc << Spell::components_to_s(val.to_i)
      when 'caster_classes'
        kl = CasterClass.where(id: val['id'])
        desc = kl.map(&:name)
      else
        desc << val
      end
    end
    content_tag(:div) do 
      t("helpers.label.spell.#{k}") + ': ' + desc.join(' or ')
    end
  end)
end
%>

